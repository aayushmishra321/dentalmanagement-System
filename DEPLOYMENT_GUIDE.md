# Django Dental Management - Render Deployment Guide

## üöÄ Quick Deployment Steps

### 1. Prerequisites
- GitHub account
- Render account (free tier works)
- Your project pushed to GitHub

### 2. Files Added/Modified for Deployment

#### ‚úÖ Updated Files:
- `requirements.txt` - Added proper versions and PostgreSQL support
- `settings.py` - Production-ready configuration with environment variables
- `build.sh` - Enhanced build script with better logging

#### ‚úÖ New Files Created:
- `runtime.txt` - Specifies Python version (3.11.7)
- `render.yaml` - Render deployment configuration
- `.env.example` - Environment variables template
- `.gitignore` - Excludes sensitive files
- `DEPLOYMENT_GUIDE.md` - This guide

### 3. Deploy on Render

#### Option A: Using render.yaml (Recommended)
1. Push all files to your GitHub repository
2. Go to [Render Dashboard](https://dashboard.render.com/)
3. Click "New" ‚Üí "Blueprint"
4. Connect your GitHub repository
5. Render will automatically detect `render.yaml` and create services

#### Option B: Manual Setup
1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click "New" ‚Üí "Web Service"
3. Connect your GitHub repository
4. Configure the following:

**Basic Settings:**
- **Name**: `dental-management`
- **Environment**: `Python 3`
- **Build Command**: `./build.sh`
- **Start Command**: `gunicorn dentalmanagement.wsgi:application`

**Environment Variables:**
```
DEBUG=False
SECRET_KEY=your-secret-key-here
EMAIL_HOST_USER=dentalmanagement00@gmail.com
EMAIL_HOST_PASSWORD=kkucitcmwrzeoxsj
```

### 4. Database Setup

#### Create PostgreSQL Database:
1. In Render Dashboard, click "New" ‚Üí "PostgreSQL"
2. **Name**: `dental-management-db`
3. **Database Name**: `dentalmanagement`
4. **User**: `dentaluser`
5. Click "Create Database"

#### Connect Database to Web Service:
1. Go to your web service settings
2. Add environment variable:
   - **Key**: `DATABASE_URL`
   - **Value**: Copy the "Internal Database URL" from your PostgreSQL service

### 5. Post-Deployment Steps

#### Create Superuser (Admin):
1. Go to your web service in Render
2. Click "Shell" tab
3. Run: `python manage.py createsuperuser`
4. Follow prompts to create admin user

#### Access Your Application:
- Your app will be available at: `https://your-service-name.onrender.com`
- Admin panel: `https://your-service-name.onrender.com/admin/`

## üîß Configuration Details

### Environment Variables Explained

| Variable | Description | Example |
|----------|-------------|---------|
| `DEBUG` | Enable/disable debug mode | `False` |
| `SECRET_KEY` | Django secret key | Auto-generated by Render |
| `DATABASE_URL` | PostgreSQL connection string | Auto-provided by Render |
| `EMAIL_HOST_USER` | Gmail username | `your-email@gmail.com` |
| `EMAIL_HOST_PASSWORD` | Gmail app password | `your-app-password` |

### Key Changes Made

#### 1. Database Configuration
```python
# Now supports both PostgreSQL (production) and SQLite (development)
if config('DATABASE_URL', default=None):
    DATABASES = {
        'default': dj_database_url.parse(config('DATABASE_URL'))
    }
else:
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',
            'NAME': BASE_DIR / 'db.sqlite3',
        }
    }
```

#### 2. Static Files Configuration
```python
STATIC_URL = '/static/'
STATIC_ROOT = BASE_DIR / 'staticfiles'
STATICFILES_DIRS = [BASE_DIR / "static"]
STATICFILES_STORAGE = 'whitenoise.storage.CompressedManifestStaticFilesStorage'
```

#### 3. Security Settings
```python
# Production security settings
if not DEBUG:
    SECURE_BROWSER_XSS_FILTER = True
    SECURE_CONTENT_TYPE_NOSNIFF = True
    SECURE_HSTS_INCLUDE_SUBDOMAINS = True
    SECURE_HSTS_SECONDS = 31536000
    SECURE_SSL_REDIRECT = True
    SESSION_COOKIE_SECURE = True
    CSRF_COOKIE_SECURE = True
```

## üêõ Troubleshooting

### Common Issues and Solutions

#### 1. Build Fails - "No module named 'decouple'"
**Solution**: Make sure `requirements.txt` includes `python-decouple==3.8`

#### 2. Static Files Not Loading
**Solution**: 
- Ensure `STATIC_ROOT` is set correctly
- Check that `whitenoise.middleware.WhiteNoiseMiddleware` is in `MIDDLEWARE`
- Run `python manage.py collectstatic` locally to test

#### 3. Database Connection Error
**Solution**:
- Verify `DATABASE_URL` environment variable is set
- Check PostgreSQL service is running
- Ensure database name matches in both services

#### 4. Email Not Working
**Solution**:
- Use Gmail App Password, not regular password
- Enable 2-factor authentication on Gmail
- Generate app-specific password

#### 5. CSRF Token Errors
**Solution**:
- Add your Render domain to `ALLOWED_HOSTS`
- Check CSRF settings in production

### Logs and Debugging

#### View Logs:
1. Go to your web service in Render
2. Click "Logs" tab
3. Monitor for errors during deployment

#### Common Log Messages:
- ‚úÖ `Build completed successfully!` - Build successful
- ‚úÖ `Starting Gunicorn` - Server starting
- ‚ùå `ModuleNotFoundError` - Missing dependency
- ‚ùå `Database connection failed` - Database issue

## üìù Local Development

### Setup for Local Development:
1. Create virtual environment:
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

2. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

3. Create `.env` file:
   ```bash
   cp .env.example .env
   # Edit .env with your local settings
   ```

4. Run migrations:
   ```bash
   python manage.py migrate
   ```

5. Create superuser:
   ```bash
   python manage.py createsuperuser
   ```

6. Run development server:
   ```bash
   python manage.py runserver
   ```

## üîí Security Notes

### Important Security Considerations:
1. **Never commit `.env` files** - Contains sensitive data
2. **Use strong SECRET_KEY** - Let Render generate it
3. **Keep DEBUG=False** in production
4. **Use HTTPS** - Render provides this automatically
5. **Regular updates** - Keep dependencies updated

### Email Security:
- Use Gmail App Passwords, not regular passwords
- Enable 2-factor authentication
- Consider using environment variables for email credentials

## üìä Monitoring and Maintenance

### Health Checks:
- Render automatically monitors your service
- Check logs regularly for errors
- Monitor database usage

### Updates:
1. Push changes to GitHub
2. Render automatically redeploys
3. Monitor logs during deployment

## üéâ Success Checklist

- [ ] All files pushed to GitHub
- [ ] Render web service created
- [ ] PostgreSQL database created and connected
- [ ] Environment variables configured
- [ ] Build completed successfully
- [ ] Application accessible via Render URL
- [ ] Admin panel working
- [ ] Email functionality tested
- [ ] Static files loading correctly

## üìû Support

If you encounter issues:
1. Check Render logs first
2. Verify environment variables
3. Test locally with same configuration
4. Check Render documentation: https://render.com/docs
5. Django deployment guide: https://docs.djangoproject.com/en/4.2/howto/deployment/

Your Django Dental Management System is now ready for production deployment on Render! üöÄ